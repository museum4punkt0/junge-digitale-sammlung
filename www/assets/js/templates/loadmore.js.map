{"version":3,"names":["element","document","querySelector","button","limit","parseInt","getAttribute","offset","fetchPages","async","url","window","location","href","split","urlwithtag","firstpart","tagVar","replace","response","fetch","html","more","json","hidden","innerHTML","error","addEventListener"],"sources":["../../../../src/js/templates/loadmore.js"],"sourcesContent":["const element = document.querySelector('.load-more-container');\nconst button = document.querySelector('.load-more-btn');\nconst limit = parseInt(element.getAttribute('data-limit'));\nlet offset = 0;\n\n/**\n * Fetches loadmore items via ajax call and json response\n */\nconst fetchPages = async () => {\n  let url = `${window.location.href.split('?')[0]}`;\n  let urlwithtag = url.split('/tag:');\n  let firstpart = urlwithtag[0];\n  let tagVar = urlwithtag[1];\n  firstpart = removeChar(firstpart);\n  url = `${firstpart}.json/tag:${tagVar}?offset=${offset}&limit=${limit}`;\n  console.log(url); \n  try {\n    const response = await fetch(url);\n    const { html, more } = await response.json();\n    button.hidden = !more;\n    element.innerHTML += html;\n    offset += limit;\n  } catch (error) {\n    console.log('Fetch error: ', error);\n  }\n}\n\n/**\n * Removes unwanted characters in case of kirby tags in URL (please refer to kirby tags)\n * @param {string} str \n * @returns {string}\n */\nfunction removeChar(str) {\n  var s = str.replace(/\\/$/, '');\n  return s;\n}\n\n// load the first pages\nfetchPages();\n\nbutton.addEventListener('click', fetchPages);\n"],"mappings":"2FAAA,MAAMA,EAAUC,SAASC,cAAc,wBACjCC,EAASF,SAASC,cAAc,kBAChCE,EAAQC,SAASL,EAAQM,aAAa,eAC5C,IAAIC,EAAS,EAKb,MAAMC,EAAaC,UACjB,IAAIC,EAAM,GAAGC,OAAOC,SAASC,KAAKC,MAAM,KAAK,KACzCC,EAAaL,EAAII,MAAM,SACvBE,EAAYD,EAAW,GACvBE,EAASF,EAAW,GACxBC,EAAuBA,EAoBXE,QAAQ,MAAO,IAnB3BR,EAAM,GAAGM,cAAsBC,YAAiBV,WAAgBH,IAEhE,IACE,MAAMe,QAAiBC,MAAMV,IACvBW,KAAEA,EAAIC,KAAEA,SAAeH,EAASI,OACtCpB,EAAOqB,QAAUF,EACjBtB,EAAQyB,WAAaJ,EACrBd,GAAUH,CACd,CAAI,MAAOsB,GAEX,GAcAlB,IAEAL,EAAOwB,iBAAiB,QAASnB,E"}